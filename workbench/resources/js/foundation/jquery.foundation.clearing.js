(function(f,m){var g={templates:{viewing:'<a href="#" class="clearing-close">&times;</a><div class="visible-img" style="display: none"><img src="#"><p class="clearing-caption"></p><a href="#" class="clearing-main-left"></a><a href="#" class="clearing-main-right"></a></div>'},initialized:!1,locked:!1},l={},e={init:function(){return this.find("ul[data-clearing]").each(function(){f(document);var a=f(this),b=b||{},c=c||{};a.data("fndtn.clearing.settings")||(b.$parent=a.parent(),a.data("fndtn.clearing.settings",
f.extend({},g,b)),e.extend(e,c),e.assemble(a.find("li")),g.initialized||e.events())})},events:function(){var a=f(document);a.on("click.fndtn.clearing","ul[data-clearing] li",function(b,a,d){a=a||f(this);d=d||a;var g=a.parent().data("fndtn.clearing.settings");b.preventDefault();g||a.parent().foundationClearing();e.open(f(b.target),a,d);e.update_paddles(d)});f(m).on("resize.fndtn.clearing",function(){var b=f(".clearing-blackout .visible-img").find("img");0<b.length&&e.center(b)});a.on("click.fndtn.clearing",
".clearing-main-right",function(b){var a=f(".clearing-blackout").find("ul[data-clearing]");b.preventDefault();e.go(a,"next")});a.on("click.fndtn.clearing",".clearing-main-left",function(a){var c=f(".clearing-blackout").find("ul[data-clearing]");a.preventDefault();e.go(c,"prev")});a.on("click.fndtn.clearing","a.clearing-close, div.clearing-blackout, div.visible-img",function(a){var c;c=f(this);c=/blackout/.test(c.selector)?c:c.closest(".clearing-blackout");var d;this===a.target&&c&&(a=c.find("div:first"),
d=a.find(".visible-img"),g.prev_index=0,c.find("ul[data-clearing]").attr("style",""),c.removeClass("clearing-blackout"),a.removeClass("clearing-container"),d.hide());return!1});a.on("keydown.fndtn.clearing",function(a){var c=f(".clearing-blackout").find("ul[data-clearing]");39===a.which&&e.go(c,"next");37===a.which&&e.go(c,"prev");27===a.which&&f("a.clearing-close").trigger("click")});a.on("movestart",function(a){(a.distX>a.distY&&a.distX<-a.distY||a.distX<a.distY&&a.distX>-a.distY)&&a.preventDefault()});
a.bind("swipeleft","ul[data-clearing] li",function(){var a=f(".clearing-blackout").find("ul[data-clearing]");e.go(a,"next")});a.bind("swiperight","ul[data-clearing] li",function(){var a=f(".clearing-blackout").find("ul[data-clearing]");e.go(a,"prev")});g.initialized=!0},assemble:function(a){var b=a.parent();a=b.data("fndtn.clearing.settings");b=b.detach();b='<div class="carousel">'+this.outerHTML(b[0])+"</div>";return a.$parent.append('<div class="clearing-assembled"><div>'+a.templates.viewing+b+
"</div></div>")},open:function(a,b,c){var d=c.closest(".clearing-assembled"),f=d.find("div:first"),g=f.find(".visible-img"),h=g.find("img").not(a);e.locked()||(h.attr("src",this.load(a)),h.is_good(function(){d.addClass("clearing-blackout");f.addClass("clearing-container");e.caption(g.find(".clearing-caption"),a);g.show();e.fix_height(c);e.center(h);e.shift(b,c,function(){c.siblings().removeClass("visible");c.addClass("visible")})}))},fix_height:function(a){a=a.siblings();a.each(function(){var a=f(this),
c=a.find("img");a.height()>c.outerHeight()&&a.addClass("fix-height")});a.closest("ul").width(100*a.length+"%")},update_paddles:function(a){var b=a.closest(".carousel").siblings(".visible-img");0<a.next().length?b.find(".clearing-main-right").removeClass("disabled"):b.find(".clearing-main-right").addClass("disabled");0<a.prev().length?b.find(".clearing-main-left").removeClass("disabled"):b.find(".clearing-main-left").addClass("disabled")},load:function(a){var b=a.parent().attr("href");this.preload(a);
return b?b:a.attr("src")},preload:function(a){var b=a.closest("li").next();a=a.closest("li").prev();var c,d;0<b.length&&(d=new Image,c=b.find("a"),d.src=0<c.length?c.attr("href"):b.find("img").attr("src"));0<a.length&&(c=new Image,b=a.find("a"),c.src=0<b.length?b.attr("href"):a.find("img").attr("src"))},caption:function(a,b){var c=b.data("caption");c?a.text(c).show():a.text("").hide()},go:function(a,b){var c=a.find(".visible"),d=c[b]();0<d.length&&d.find("img").trigger("click",[c,d])},shift:function(a,
b,c){var d=b.parent();d.closest(".clearing-container");b.position();d.position();var f=g.prev_index,k=this.direction(d,a,b),h=parseInt(d.css("left"),10);a=b.outerWidth();b.index()!==f&&!/skip/.test(k)?/left/.test(k)?(e.lock(),d.animate({left:h+a},300,e.unlock)):/right/.test(k)&&(e.lock(),d.animate({left:h-a},300,e.unlock)):/skip/.test(k)&&(b=b.index()-g.up_count,e.lock(),0<b?d.animate({left:-(b*a)},300,e.unlock):d.animate({left:0},300,e.unlock));c()},lock:function(){g.locked=!0},unlock:function(){g.locked=
!1},locked:function(){return g.locked},direction:function(a,b,c){a=a.find("li");var d=a.outerWidth()+a.outerWidth()/4,e=f(".clearing-container"),d=Math.floor(e.outerWidth()/d)-1;c=a.index(c);a.index(b);g.up_count=d;b=this.adjacent(g.prev_index,c)?c>d&&c>g.prev_index?"right":c>d-1&&c<=g.prev_index?"left":!1:"skip";g.prev_index=c;return b},adjacent:function(a,b){return b-1===a||b+1===a||b===a?!0:!1},center:function(a){a.css({marginLeft:-(a.outerWidth()/2),marginTop:-(a.outerHeight()/2)})},outerHTML:function(a){return a.outerHTML||
(new XMLSerializer).serializeToString(a)},extend:function(a,b){f.each(a,function(a,d){b.hasOwnProperty(a)&&(l[a]=d)});f.extend(e,b)},_super:function(a,b){return l[a].apply(this,b)}};f.fn.foundationClearing=function(a){if(e[a])return e[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return e.init.apply(this,arguments);f.error("Method "+a+" does not exist on jQuery.foundationClearing")};var j=jQuery;j.fn.is_good=function(a,b){function c(){g-=1;!g&&a()}function d(){this.one("load",
c);if(j.browser.msie){var a=this.attr("src"),b=a.match(/\?/)?"&":"?",b=b+(e.cachePrefix+"="+(new Date).getTime());this.attr("src",a+b)}}var e=j.extend({},j.fn.is_good.defaults,b),f=this.find("img").add(this.filter("img")),g=f.length;return f.each(function(){var a=j(this);a.attr("src")?this.complete||4===this.readyState?c():d.call(a):c()})};j.fn.is_good.defaults={cachePrefix:"random"}})(jQuery,this);